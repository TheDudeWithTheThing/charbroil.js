// Generated by CoffeeScript 1.3.3
(function(e,t){var n,r,i,s;return s="charbroil",i=t.document,r={hot_key_css_class:"charbroil-hot",modifier:"ctrl",exclude:[]},n=function(){function n(t,n){this.element=t,this.options=e.extend({},r,n),this._defaults=r,this._name=s,this._letter_score=[],this.init()}return n.prototype.init=function(){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g;this.load_links(),v=this.links;for(u=0,c=v.length;u<c;u++){s=v[u],t=e(s),o=t.html();for(a=0,h=o.length;a<h;a++)r=o[a],n=r.toLowerCase(),typeof this._letter_score[n]=="undefined"&&(this._letter_score[n]=0),this._letter_score[n]++}m=this.links;for(f=0,p=m.length;f<p;f++){s=m[f],t=e(s),i=t.attr("data-charbroil-key"),o=t.html();if(!this.is_valid_letter(i)){i=o[0].toLowerCase();if(!this.is_valid_letter(i))continue}this.build_char_link(i,o,t)}g=this.links;for(l=0,d=g.length;l<d;l++){s=g[l];if(this.has_charbroil_span(s))continue;o=e(s).html(),i=this.find_lowest_score_letter(o.toLowerCase());if(!this.is_valid_letter(i))continue;this.build_char_link(i.toLowerCase(),o.toLowerCase(),s)}return this.element},n.prototype.is_valid_letter=function(e){return e&&this.options.exclude.indexOf(e)===-1},n.prototype.has_charbroil_span=function(t){return e(t).find("span."+this.options.hot_key_css_class).length>0},n.prototype.build_char_link=function(n,r,i){var s,o,u,a,f;return this.options.exclude.push(n),r=r.toLowerCase(),a=this.build_shortcut_string(n),f=this.build_shortcut_class_name(a),o=this.get_finder_class_name(f),u='<span class="'+this.options.hot_key_css_class+'">'+n+"</span>",s=e(i),s.html(s.html().replace(n,u)),s.addClass(f),key(a,function(n,r){return f="charbroil-"+r.shortcut.replace("+","-"),t.location=e("."+f).attr("href")})},n.prototype.load_links=function(){return this.links=e(this.element).find("a")},n.prototype.find_lowest_score_letter=function(e){var t,n,r,i,s;for(i=0,s=e.length;i<s;i++)t=e[i],this.is_valid_letter(t)&&(!r||r&&this._letter_score[t]<r)&&(n=t,r=this._letter_score[t]);return n},n.prototype.build_shortcut_string=function(e){var t,n;return this.options.modifier instanceof Array?(n=function(){var n,r,i,s;i=this.options.modifier,s=[];for(n=0,r=i.length;n<r;n++)t=i[n],s.push(t+"+"+e);return s}.call(this),n.join(",")):this.options.modifier+"+"+e},n.prototype.build_shortcut_class_name=function(e){var t,n;return t=function(){var t,r,i,s;i=e.split(/,/),s=[];for(t=0,r=i.length;t<r;t++)n=i[t],s.push("charbroil-"+n.replace(/\+/g,"-"));return s}(),t.join(" ")},n.prototype.get_finder_class_name=function(e){var t;return t=e.split(" "),t[0]},n}(),e.fn[s]=function(t){return this.each(function(){if(!e.data(this,"plugin_"+s))return e.data(this,"plugin_"+s,new n(this,t))})}})(jQuery,window);